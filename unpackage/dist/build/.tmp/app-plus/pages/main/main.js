(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/main/main"],{"0cf2":function(e,n,t){"use strict";var i=t("b82e"),a=t.n(i);a.a},"9c11":function(e,n,t){"use strict";(function(e){t("e3a0"),t("921b");i(t("66fd"));var n=i(t("d7a1"));function i(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("6e42")["createPage"])},b82e:function(e,n,t){},b97c:function(e,n,t){"use strict";t.r(n);var i=t("dffe"),a=t.n(i);for(var o in i)"default"!==o&&function(e){t.d(n,e,function(){return i[e]})}(o);n["default"]=a.a},d7a1:function(e,n,t){"use strict";t.r(n);var i=t("f1a1"),a=t("b97c");for(var o in a)"default"!==o&&function(e){t.d(n,e,function(){return a[e]})}(o);t("0cf2");var s,c=t("f0c5"),u=Object(c["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);n["default"]=u.exports},dffe:function(e,n,t){"use strict";(function(e,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(t("a34a")),o=t("1989"),s=r(t("51a4")),c=t("ea30"),u=t("8ceb");function r(e){return e&&e.__esModule?e:{default:e}}function l(e,n,t,i,a,o,s){try{var c=e[o](s),u=c.value}catch(r){return void t(r)}c.done?n(u):Promise.resolve(u).then(i,a)}function m(e){return function(){var n=this,t=arguments;return new Promise(function(i,a){var o=e.apply(n,t);function s(e){l(o,i,a,s,c,"next",e)}function c(e){l(o,i,a,s,c,"throw",e)}s(void 0)})}}var d={data:function(){return{loading:!1,format:"",indexBackgroundImage:s.default,images:[],storageArr:[],imagecontent:"",Pine:{height:"",dhb:"",circumference:"",postscript:"",latitude:"",longitude:"",altitude:"",pinenum:"",username:"",userid:"",owner:"",classnum:"",id:"",done:0,time:(0,c.formatDate)((new Date).getTime()),imagenum:"0001"+(0,c.Thistime)()}}},onLoad:function(n){this.hahah();try{var t=e.getStorageSync("storage_key");t&&(this.Pine.userid=t.userid,this.Pine.classnum=t.classnum,this.Pine.username=t.username,this.Pine.owner=t.owner,this.Pine.id=t.userid)}catch(a){}plus.sqlite.executeSql({name:"pineinfect",sql:'create table if not exists Researchtable("id" INT(10),"pinenum" INT(20),"latitude" INT(20),"longitude" INT(20),"altitude" INT(5),"height" INT(10),"dhb" INT(10),"circumference" INT(10),"done" INT(1),"userid" INT(10),"username" CHAR(11),"owner" INT(3),"classnum" INT(10),"time" INT(20),"imagenum" CHAR(30),"postscript" CHAR(30))',success:function(e){console.log(i("打开main表成功!"," at pages\\main\\main.vue:122"))},fail:function(e){console.log(i("打开main表失败"," at pages\\main\\main.vue:125")),console.log(i(e," at pages\\main\\main.vue:126"))}}),plus.sqlite.executeSql({name:"pineinfect",sql:'create table if not exists Imagetable("id" INT(10),"imagenum" CHAR(20),"imageorder" CHAR(20),"imagename" CHAR(20),"imageurl" CHAR(30),"imagecontent" CHAR(99999999),"progress" INT(20),"time" CHAR(30),"userid" INT(10),"owner" INT(10),"houzhui" INT(10))',success:function(e){console.log(i("打开Image表成功!"," at pages\\main\\main.vue:134"))},fail:function(e){console.log(i("打开Image表失败"," at pages\\main\\main.vue:137"))}})},methods:{hahah:function(){plus.geolocation.getCurrentPosition(function(e){console.log(i(e," at pages\\main\\main.vue:144"))})},Notnetwork:function(){var n=this;e.getLocation({type:"gcj02",success:function(e){console.log(i(e," at pages\\main\\main.vue:153")),n.Pine.latitude=e.latitude.toFixed(6),n.Pine.longitude=e.longitude.toFixed(6)}})},Tomainsql:function(){e.navigateTo({url:"../mainsql/mainsql"})},Toresearchday:function(){e.navigateTo({url:"../researchday/researchday"})},getlocation:function(){var n=this;e.chooseLocation({success:function(e){console.log(i(e," at pages\\main\\main.vue:174")),n.Pine.latitude=e.latitude.toFixed(6),n.Pine.longitude=e.longitude.toFixed(6),n.Pine.altitude=e.address}})},Dhb:function(){this.Pine.circumference=3.14*this.Pine.dhb,console.log(i(this.Pine.circumference," at pages\\main\\main.vue:184"))},close:function(e){this.images.splice(e,1)},chooseImg:function(n){var t=this;e.chooseImage({sourceType:["camera"],sizeType:"compressed",count:3-this.images.length,success:function(e){(0,u.pathToBase64)(e.tempFilePaths[0]).then(function(e){var n=e.indexOf("/"),i=e.indexOf(";"),a=e.substr(n+1,i-n-1);t.format=a;var o=e.indexOf(",");t.imagecontent=t.imagecontent.concat(e.substring(o+1,e.length)+";")}).catch(function(e){console.error(i(e," at pages\\main\\main.vue:209"))}),t.images=t.images.concat(e.tempFilePaths)}})},previewImage:function(){e.previewImage({urls:this.images})},addlocation:function(){var n=this;n.Pine.pinenum.length>=10&&n.images.length>0?(plus.sqlite.executeSql({name:"pineinfect",sql:"insert into Imagetable values('"+n.Pine.id+"','"+n.Pine.imagenum+"','Pine','Pine.png','"+n.imageurl+"','"+n.imagecontent+"','1','"+n.Pine.time+"','"+n.Pine.userid+"','"+n.owner+"','"+n.format+"')",success:function(n){console.log(i("添加图片成功!"," at pages\\main\\main.vue:251")),e.showToast({title:"添加图片成功!"})},fail:function(n){console.log(i("添加图片失败!"," at pages\\main\\main.vue:257")),e.showToast({icon:"fail",title:"添加图片失败!"})}}),plus.sqlite.executeSql({name:"pineinfect",sql:"insert into Researchtable values('"+n.Pine.id+"','"+n.Pine.pinenum+"','"+n.Pine.latitude+"','"+n.Pine.longitude+"','"+n.Pine.altitude+"','"+n.Pine.height+"','"+n.Pine.dhb+"','"+n.Pine.circumference+"','"+n.Pine.done+"','"+n.Pine.userid+"','"+n.Pine.username+"','"+n.Pine.owner+"','"+n.Pine.classnum+"','"+n.Pine.time+"','"+n.Pine.imagenum+"','"+n.Pine.postscript+"')",success:function(n){console.log(i("添加信息成功!"," at pages\\main\\main.vue:301")),e.showToast({title:"添加信息成功!"})},fail:function(n){e.showToast({icon:"fail",title:"添加信息失败!"})}}),e.showModal({showCancel:!1,title:"提示",content:"存入本地成功!",success:function(n){n.confirm&&e.redirectTo({url:"../startNav/startNav",success:function(){e.redirectTo({url:"../main/main"})}})}})):e.showModal({title:"提示",content:"信息填写不完整"})},send:function(){var n=this;n.loading=!0,e.getNetworkType({success:function(){var t=m(a.default.mark(function t(i){var s,c,u;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("4g"!=i.networkType&&"wifi"!=i.networkType){t.next=34;break}if(!(n.Pine.pinenum.length>=10&&n.images.length>0)){t.next=28;break}return e.showLoading({title:"提交中……"}),t.next=5,(0,o.addPine)(n.Pine);case 5:if(s=t.sent,setTimeout(function(){e.hideLoading(),n.loading=!1},15e3),1!==s.data){t.next=23;break}c=n.imagecontent.split(";"),c.pop(),u=0;case 11:if(!(u<c.length)){t.next=18;break}return t.next=14,(0,o.addImage)({imagecontent:c[u],id:n.Pine.id,imagenum:n.Pine.imagenum,imageorder:u+1,imagename:u+"."+n.format,progress:1,imageurl:"",time:n.Pine.time,userid:n.Pine.userid,owner:n.Pine.owner});case 14:t.sent;case 15:u++,t.next=11;break;case 18:n.loading=!1,e.hideLoading(),e.showModal({showCancel:!1,title:"提示",content:"提交成功!",success:function(n){n.confirm&&e.redirectTo({url:"../startNav/startNav",success:function(){e.redirectTo({url:"../main/main"})}})}}),t.next=26;break;case 23:n.loading=!1,e.hideLoading(),e.showModal({showCancel:!1,title:"提示",content:"请求失败，二维码可能重复提交。"});case 26:t.next=32;break;case 28:return n.loading=!1,e.hideLoading(),e.showModal({showCancel:!1,title:"提示",content:"信息填写不完整或编号格式不正确"}),t.abrupt("return");case 32:t.next=37;break;case 34:n.loading=!1,e.hideLoading(),e.showModal({showCancel:!1,title:"提示",content:"没有网络，是否存入本地",success:function(e){n.addlocation()}});case 37:case"end":return t.stop()}},t,this)}));function i(e){return t.apply(this,arguments)}return i}()})},scan:function(){var n=m(a.default.mark(function n(){var t=this;return a.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:e.scanCode({success:function(e){var n=e.result.indexOf(",");t.Pine.pinenum=-1==n?e.result:e.result.substring(0,n)},fail:function(e){console.log(i(e," at pages\\main\\main.vue:444"))}});case 1:case"end":return n.stop()}},n,this)}));function t(){return n.apply(this,arguments)}return t}()}};n.default=d}).call(this,t("6e42")["default"],t("0de9")["default"])},f1a1:function(e,n,t){"use strict";var i,a=function(){var e=this,n=e.$createElement;e._self._c},o=[];t.d(n,"b",function(){return a}),t.d(n,"c",function(){return o}),t.d(n,"a",function(){return i})}},[["9c11","common/runtime","common/vendor"]]]);